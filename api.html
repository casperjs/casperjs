<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="http://casperjs.org/">
    <title>API documentation | CasperJS 0.6.9</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <meta name="keywords" content="phantomjs, phantom, casperjs, casper, browser, javascript, navigation, scripting, test, testing, scrape, scraping">
    <meta name="description" content="CasperJS is a browser navigation scripting &amp; testing utility written in Javascript on top of PhantomJS.">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Asap:400,700,400italic,700italic&amp;subset=latin,latin-ext">
    <link rel="stylesheet" href="prettify/prettify.css">
    <link rel="stylesheet" href="css/casper.css">
    <link rel="shortcut icon" href="favicon.ico">
</head>
<body>
    <a href="http://github.com/n1k0/casperjs" class="contribute">
        <img src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
    </a>
    <div class="navbar navbar-fixed-top" data-spy="scroll" id="topbar">
        <div class="navbar-inner">
            <div class="container">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="brand" href="./index.html">CasperJS</a>
                <div class="nav-collapse">
                    <ul class="nav">
                        <li><a href="installation.html">Install</a></li>
                        <li><a href="quickstart.html">Quickstart</a></li>
                        <li class="active"><a href="api.html">API</a></li>
                        <li><a href="cli.html"><acronym title="Command Line Interface">CLI</acronym></a></li>
                        <li><a href="selectors.html">Selectors</a></li>
                        <li><a href="events-filters.html">Events</a></li>
                        <li><a href="client-utils.html">Client-side utils</a></li>
                        <li><a href="logging.html">Logging</a></li>
                        <li><a href="extending.html">Extending</a></li>
                        <li><a href="testing.html">Testing</a></li>
                        <li><a href="debugging.html">Debugging</a></li>
                        <li><a href="faq.html"><acronym title="Frequently Asked Questions">FAQ</acronym></a></li>
                        <li><a href="https://groups.google.com/forum/#!forum/casperjs">Support</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="container" id="overview">
        <div class="content"><section>
    <div class="page-header">
        <h1>
            <span class="section-title">API documentation</span>
            
        </h1>
    </div>
    <div class="row">
        <div class="span9 section-content"><p>Casper source code is quite heavily documented using <code>jsdoc</code>, but below
you'll find the whole API documentation with sample code.

</p>
<h2>The Casper class</h2>
<p>The most easiest way to instantiate a casper instance is to use the
module <code>create()</code> method:

</p>
<pre><code class="javascript">var casper = require('casper').create();</code></pre>
<p>But you can also retrieve the main Function and instantiate it by
yourself:

</p>
<pre><code class="javascript">var casper = new require('casper').Casper();</code></pre>
<h3 id="options"><code>Casper([Object options])</code></h3>

<p>Both the <code>Casper</code> constructor and the <code>create()</code> function accept a
single <code>options</code> argument which is a standard javascript object:

</p>
<pre><code class="javascript">var casper = require('casper').create({
    verbose: true,
    logLevel: "debug"
});</code></pre>
<h2>Casper options</h2>
<p>All the available options are detailed below:

</p>
<table class="table table-striped table-condensed" caption="Casper options">
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>clientScripts</code></td>
      <td><code>Array</code></td>
      <td><code>[]</code></td>
      <td>
        A collection of script filepaths to include to every
        page loaded
      </td>
    </tr>
    <tr>
      <td><code>exitOnError</code></td>
      <td><code>Boolean</code></td>
      <td><code>true</code></td>
      <td>
        Sets if CasperJS must exist when any uncaught error has been thrown by
        the script.
      </td>
    </tr>
    <tr>
      <td><code>httpStatusHandlers</code></td>
      <td><code>Object</code></td>
      <td><code>{}</code></td>
      <td>
        A javascript Object containing functions to call when a
        requested resource has a given HTTP status code. A
        <a href="https://github.com/n1k0/casperjs/blob/master/samples/statushandlers.js">dedicated
        sample</a> is provided as an example.
      </td>
    </tr>
    <tr>
      <td><code>logLevel</code></td>
      <td><code>String</code></td>
      <td><code>"error"</code></td>
      <td>
        Logging level (see the <a href="#logging">logging
        section</a> for more information)
      </td>
    </tr>
    <tr>
      <td><code>onAlert</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>
        A function to be called when a javascript <code>alert()</code>
        is triggered
      </td>
    </tr>
    <tr>
      <td><code>onDie</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>
        A function to be called when <code>Casper#die()</code>
        is called
      </td>
    </tr>
    <tr>
      <td><code>onError</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>
        A function to be called when an <code>"error"</code>
        level event occurs
      </td>
    </tr>
    <tr>
      <td><code>onLoadError</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>
        A function to be called when a requested resource cannot
        be loaded
      </td>
    </tr>
    <tr>
      <td><code>onPageInitialized</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>A function to be called after <code>WebPage</code>
        instance has been initialized</td>
    </tr>
    <tr>
      <td><code>onResourceReceived</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>
        Proxy method for PhantomJS' <code>WebPage#onResourceReceived()</code>
        callback, but the current Casper instance is passed as
        first argument.
      </td>
    </tr>
    <tr>
      <td><code>onResourceRequested</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>
        Proxy method for PhantomJS' <code>WebPage#onResourceRequested()</code>
        callback, but the current Casper instance is passed as
        first argument.
      </td>
    </tr>
    <tr>
      <td><code>onStepComplete</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td>A function to be executed when a step function execution
        is finished.</td>
    </tr>
    <tr>
      <td><code>onStepTimeout</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td> A function to be executed when a step function
        execution time exceeds the value of the <code>stepTimeout</code>
        option, if any has been set. </td>
    </tr>
    <tr>
      <td><code>onTimeout</code></td>
      <td><code>Function</code></td>
      <td><code>null</code></td>
      <td> A function to be executed when script execution time
        exceeds the value of the <code>timeout</code> option, if
        any has been set. </td>
    </tr>
    <tr>
      <td><code>page</code></td>
      <td><code>WebPage</code></td>
      <td><code>null</code></td>
      <td>An existing <code>WebPage</code> instance</td>
    </tr>
    <tr>
      <td><code>pageSettings</code></td>
      <td><code>Object</code></td>
      <td><code>{}</code></td>
      <td>
        <p>
          PhantomJS's <code>WebPage</code> settings object.
          <a href="http://code.google.com/p/phantomjs/wiki/Interface#settings_(object)">Available settings</a> are:
        </p>
        <ul>
          <li>
            <code>javascriptEnabled</code> defines whether to execute the
            script in the page or not (default to true)
          </li>
          <li>
            <code>loadImages</code> defines whether to load the inlined images
            or not
          </li>
          <li>
            <code>loadPlugins</code> defines whether to load NPAPI plugins
            (Flash, Silverlight, ...) or not
          </li>
          <li>
            <code>localToRemoteUrlAccessEnabled</code> defines whether local
            resource (e.g. from file) can access remote URLs or not (default to false)
          </li>
          <li>
            <code>userAgent</code> defines the user agent sent to server when
            the web page requests resources.
          </li>
          <li>
            <code>userName</code> sets the user name used for HTTP
            authentication
          </li>
          <li>
            <code>password</code> sets the password used for HTTP
            authentication
          </li>
          <li>
            <code>XSSAuditingEnabled</code> defines whether load requests
            should be monitored for cross-site scripting attempts (default to
              false)
          </li>
        </ul>
      </td>
    </tr>
    <tr>
      <td><code>stepTimeout</code></td>
      <td><code>Number</code></td>
      <td><code>null</code></td>
      <td> Max step timeout in milliseconds; when set, every
        defined step function will have to execute before this
        timeout value has been reached. You can define the <code>onStepTimeout()</code>
        callback to catch such a case. By default, the script will
        <code>die()</code> with an error message. </td>
    </tr>
    <tr>
      <td><code>timeout</code></td>
      <td><code>Number</code></td>
      <td><code>null</code></td>
      <td>Max timeout in milliseconds</td>
    </tr>
    <tr>
      <td><code>verbose</code></td>
      <td><code>Boolean</code></td>
      <td><code>false</code></td>
      <td>Realtime output of log messages</td>
    </tr>
    <tr>
      <td><code>viewportSize</code></td>
      <td><code>Object</code></td>
      <td><code>null</code></td>
      <td>Viewport size, eg. <code>{width: 800, height: 600}</code></td>
    </tr>
  </tbody>
</table>

<p><strong>Example:</strong>

</p>
<pre><code class="javascript">var casper = require('casper').create({
    clientScripts:  [
        'includes/jquery.js',      // These two scripts will be injected in remote
        'includes/underscore.js'   // DOM on every request
    ],
    logLevel: "info",              // Only "info" level messages will be logged
    onError: function(self, m) {   // Any "error" level message will be written
        console.log('FATAL:' + m); // on the console output and PhantomJS will
        self.exit();               // terminate
    },
    pageSettings: {
        loadImages:  false,        // The WebPage instance used by Casper will
        loadPlugins: false         // use these settings
    }
});</code></pre>
<p>But no worry, usually you'll just need to instantiate Casper using
<code>require('casper').create()</code>.

</p>
<h3 id="back"><code>Casper#back()</code></h3>

<p>Moves back a step in browser's history.

</p>
<pre><code class="javascript">casper.start('http://foo.bar/1')
casper.thenOpen('http://foo.bar/2');
casper.thenOpen('http://foo.bar/3');
casper.back();
casper.run(function() {
    console.log(this.getCurrentUrl()); // 'http://foo.bar/2'
});</code></pre>
<p>Also have a look at <a href="#forward"><code>Casper.forward()</code></a>.

</p>
<h3 id="base64encode"><code>Casper#base64encode(String url [, String method, Object data])</code></h3>

<p>Encodes a resource using the base64 algorithm synchronously using
client-side XMLHttpRequest.

</p>
<p><span class="label label-info">Note</span> We cannot use <code>window.btoa()</code>
because it fails miserably in the version of WebKit shipping with PhantomJS.

</p>
<p>Example: retrieving google logo image encoded in base64:

</p>
<pre><code class="javascript">var base64logo = null;
casper.start('http://www.google.fr/', function() {
    base64logo = this.base64encode('http://www.google.fr/images/srpr/logo3w.png');
});

casper.run(function() {
    this.echo(base64logo).exit();
});</code></pre>
<p>You can also perform an HTTP POST request to retrieve the contents to
encode:

</p>
<pre><code class="javascript">var base46contents = null;
casper.start('http://domain.tld/download.html', function() {
    base46contents = this.base64encode('http://domain.tld/', 'POST', {
        param1: 'foo',
        param2: 'bar'
    });
});</code></pre>
<pre><code class="javascript">casper.run(function() {
    this.echo(base46contents).exit();
});</code></pre>
<h3 id="click"><code>Casper#click(String <a href="#selectors">selector</a>)</code></h3>

<p>Performs a click on the element matching the provided <a href="selectors.html">selector expression</a>.
The method tries two strategies sequentially:

</p>
<ol>
<li>trying to trigger a MouseEvent in Javascript</li>
<li>using native QtWebKit event if the previous attempt failed</li>
</ol>
<p>Example:

</p>
<pre><code class="javascript">casper.start('http://google.fr/');

casper.thenEvaluate(function(term) {
    document.querySelector('input[name="q"]').setAttribute('value', term);
    document.querySelector('form[name="f"]').submit();
}, { term: 'CasperJS' });

casper.then(function() {
    // Click on 1st result link
    this.click('h3.r a');
});

casper.then(function() {
    console.log('clicked ok, new location is ' + this.getCurrentUrl());
});

casper.run();</code></pre>
<p><span class="label label-info">Hint</span> If you want the mouse to click a
given point within the viewport area, you can use the <code>mouse</code> property of the
<code>Casper</code> instance:

</p>
<pre><code class="javascript">casper.then(function() {
    this.mouse.click(150, 200);
});</code></pre>
<h3 id="capture"><code>Casper#capture(String targetFilepath, Object clipRect)</code></h3>

<p>Proxy method for PhantomJS' <code>WebPage#render</code>. Adds a clipRect parameter
for automatically setting page clipRect setting values and sets it back
once done.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.capture('google.png', {
        top: 100,
        left: 100,
        width: 500,
        height: 400
    });
});

casper.run();</code></pre>
<h3 id="captureSelector"><code>Casper#captureSelector(String targetFile, String <a href="#selectors">selector</a>)</code></h3>

<p>Captures the page area containing the provided selector.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.weather.com/', function() {
    this.captureSelector('weather.png', '.twc-story-block');
});

casper.run();</code></pre>
<h3 id="clear"><code>Casper#clear()</code></h3>

<p>Clears the current page execution environment context. Useful to avoid
having previously loaded DOM contents being still active.

</p>
<p>Think of it as a way to stop javascript execution within the remote DOM
environment.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.clear(); // javascript execution in this page has been stopped
});

casper.then(function() {
    // ...
});

casper.run();</code></pre>
<p><span class="label label-info">Note</span> This method has been added in 0.6.5.

</p>
<h3 id="debugHTML"><code>Casper#debugHTML()</code></h3>

<p>Logs the HTML code of the current page directly to the standard output,
for debugging purpose.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.debugHTML();
});

casper.run();</code></pre>
<h3 id="debugPage"><code>Casper#debugPage()</code></h3>

<p>Logs the textual contents of the current page directly to the standard
output, for debugging purpose.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.debugPage();
});

casper.run();</code></pre>
<h3 id="die"><code>Casper#die(String message[, int  status])</code></h3>

<p>Exits phantom with a logged error message and an optional exit status
code.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.die("Fail.", 1);
});

casper.run();</code></pre>
<h3 id="download"><code>Casper#download(String url, String target[, String method, Object data])</code></h3>

<p>Saves a remote resource onto the filesystem. You can optionally set the HTTP
method using the <code>method</code> argument, and pass request arguments through the <code>data</code>
object (see <a href="#base64encode">base64encode</a>).

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    var url = 'http://www.google.fr/intl/fr/about/corporate/company/';
    this.download(url, 'google_company.html');
});

casper.run(function() {
    this.echo('Done.').exit();
});</code></pre>
<h3 id="each"><code>Casper#each(Array array,  Function fn)</code></h3>

<p>Iterates over provided array items and execute a callback.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">var links = [
    'http://google.com/',
    'http://yahoo.com/',
    'http://bing.com/'
];

casper.start().each(links, function(self, link) {
    self.thenOpen(link, function() {
        this.echo(this.getTitle());
    });
});

casper.run();</code></pre>
<p><span class="label label-info">Hint</span> Have a look at the
<a href="https://github.com/n1k0/casperjs/blob/master/samples/googlematch.js">googlematch.js</a>
sample script for a concrete use case.

</p>
<h3 id="echo"><code>Casper#echo(String message[, String style])</code></h3>

<p>Prints something to stdout, optionally with some fancy color (see the
<a href="colorizer.html"><code>Colorizer</code></a> section of this document for more
information).

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.echo('Page title is: ' + this.evaluate(function() {
        return document.title;
    }), 'INFO'); // Will be printed in green on the console
});

casper.run();</code></pre>
<h3 id="evaluate"><code>Casper#evaluate(function fn[, Object replacements])</code></h3>

<p>Evaluates an expression <strong>in the remote page context</strong>, a bit like what PhantomJS'
<code>WebPage#evaluate</code> does, but can also handle passed arguments if you
define their context:

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.evaluate(function(username, password) {
    document.querySelector('#username').value = username;
    document.querySelector('#password').value = password;
    document.querySelector('#submit').click();
}, {
    username: 'sheldon.cooper',
    password: 'b4z1ng4'
});</code></pre>
<p><span class="label label-info">Note</span> For filling and submitting forms, rather use the
<a href="#fill"><code>Casper#fill()</code></a> method.

</p>
<p><span class="label label-info">Note</span> The concept behind this method is
probably the most difficult to understand when discovering CasperJS.
As a reminder, think of the <code>evaluate()</code> method as a <em>gate</em> between the CasperJS
environment and the one of the page you have opened; everytime you pass a closure to
<code>evaluate()</code>, you're entering the page and execute code as if you were using the
browser console.

</p>
<p>Here's a quickly drafted diagram trying to basically explain the separation of
concerns:

</p>
<p><img src="images/evaluate-diagram.png" alt="diagram">

</p>
<h3 id="evaluateOrDie"><code>Casper#evaluateOrDie(function fn[, String message])</code></h3>

<p>Evaluates an expression within the current page DOM and <code>die()</code> if it
returns anything but <code>true</code>.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://foo.bar/home', function() {
    this.evaluateOrDie(function() {
        return /logged in/.match(document.title);
    }, 'not authenticated');
});

casper.run();</code></pre>
<h3 id="exit"><code>Casper#exit([int status])</code></h3>

<p>Exits PhantomJS with an optional exit status code.

</p>
<h3 id="exists"><code>Casper#exists(String <a href="#selectors">selector</a>)</code></h3>

<p>Checks if any element within remote DOM matches the provided
<a href="selectors.html">selector</a>.

</p>
<pre><code class="javascript">casper.start('http://foo.bar/home', function() {
    if (this.exists('#my_super_id')) {
        this.echo('found #my_super_id', 'INFO');
    } else {
        this.echo('#my_super_id not found', 'ERROR');
    }
});

casper.run();</code></pre>
<h3 id="fetchText"><code>Casper#fetchText(String <a href="#selectors">selector</a>)</code></h3>

<p>Retrieves text contents matching a given <a href="selectors.html">selector expression</a>.
If you provide one matching more than one element, their textual contents will
be concatenated.

</p>
<pre><code class="javascript">casper.start('http://google.com/search?q=foo', function() {
    this.echo(this.fetchText('h3'));
}).run();</code></pre>
<h3 id="forward"><code>Casper#forward()</code></h3>

<p>Moves a step forward in browser's history.

</p>
<pre><code class="javascript">casper.start('http://foo.bar/1')
casper.thenOpen('http://foo.bar/2');
casper.thenOpen('http://foo.bar/3');
casper.back();    // http://foo.bar/2
casper.back();    // http://foo.bar/1
casper.forward(); // http://foo.bar/2
casper.run();</code></pre>
<p>Also have a look at <a href="#back"><code>Casper.back()</code></a>.

</p>
<h3 id="log"><code>Casper#log(String message[, String level, String space])</code></h3>

<p>Logs a message with an optional level in an optional space. Available
levels are <code>debug</code>, <code>info</code>, <code>warning</code> and <code>error</code>. A space is a kind of
namespace you can set for filtering your logs. By default, Casper logs
messages in two distinct spaces: <code>phantom</code> and <code>remote</code>, to distinguish
what happens in the PhantomJS environment from the remote one.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.log("I'm logging an error", "error");
});

casper.run();</code></pre>
<h3 id="fill"><code>Casper#fill(String <a href="#selectors">selector</a>,  Object values[, Boolean submit])</code></h3>

<p>Fills the fields of a form with given values and optionally submits it.

</p>
<p>Example with this sample html form:

</p>
<pre><code class="html">&lt;form action="/contact" id="contact-form" enctype="multipart/form-data"&gt;
    &lt;input type="text" name="subject"/&gt;
    &lt;textearea name="content"&gt;&lt;/textearea&gt;
    &lt;input type="radio" name="civility" value="Mr"/&gt; Mr
    &lt;input type="radio" name="civility" value="Mrs"/&gt; Mrs
    &lt;input type="text" name="name"/&gt;
    &lt;input type="email" name="email"/&gt;
    &lt;input type="file" name="attachment"/&gt;
    &lt;input type="checkbox" name="cc"/&gt; Receive a copy
    &lt;input type="submit"/&gt;
&lt;/form&gt;</code></pre>
<p>A script to fill and submit this form:

</p>
<pre><code class="javascript">casper.start('http://some.tld/contact.form', function() {
    this.fill('form#contact-form', {
        'subject':    'I am watching you',
        'content':    'So be careful.',
        'civility':   'Mr',
        'name':       'Chuck Norris',
        'email':      'chuck@norris.com',
        'cc':         true,
        'attachment': '/Users/chuck/roundhousekick.doc'
    }, true);
});

casper.then(function() {
    this.evaluateOrDie(function() {
        return /message sent/.test(document.body.innerText);
    }, 'sending message failed');
});

casper.run(function() {
    this.echo('message sent').exit();
});</code></pre>
<p>Please Don't use CasperJS nor PhantomJS to send spam, or I'll be calling
the Chuck. More seriously, please just don't.

</p>
<p><span class="label label-warning">Warning</span> The <code>fill()</code> method currently
can't fill <strong>file fields</strong>; PhantomJS natively only allows the use of
<a href="selectors.html">selectors</a> in
<a href="http://code.google.com/p/phantomjs/wiki/Interface#uploadFile(selector,_fileName)">its
uploadFile method</a>, hence this limitation.

</p>
<h3 id="getCurrentUrl"><code>Casper#getCurrentUrl()</code></h3>

<p>Retrieves current page URL. <span class="label label-info">Note</span> the url
will be url-decoded.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.echo(this.getCurrentUrl()); // "http://www.google.fr/"
});

casper.run();</code></pre>
<h3 id="getGlobal"><code>Casper#getGlobal(String name)</code></h3>

<p>Retrieves a global variable value within the remote DOM environment by
its name. Basically, <code>getGlobal('foo')</code> will retrieve the value of <code>window.foo</code>
from the page.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.echo(this.getGlobal('innerWidth')); // 1024
});

casper.run();</code></pre>
<h3 id="getTitle"><code>Casper#getTitle()</code></h3>

<p>Retrieves current page title.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.echo(this.getTitle()); // "Google"
});

casper.run();</code></pre>
<h3 id="mouseEvent"><code>Casper#mouseEvent(String type, String <a href="#selectors">selector</a>)</code></h3>

<p>Trigger a mouse event on the first element found matching the provided selector.

</p>
<p>Supported events are <code>mouseup</code>, <code>mousedown</code>, <code>click</code>, <code>mousemove</code>, <code>mouseover</code>
and <code>mouseout</code>.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.fr/', function() {
    this.mouseEvent('click', 'h2 a');
});

casper.run();</code></pre>
<h3 id="open"><code>Casper#open(String location, Object Settings)</code></h3>

<p>Performs an HTTP request for opening a given location. You can forge
<code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code> and <code>HEAD</code> requests.

</p>
<p><strong>Example for a standard <code>GET</code> request:</strong>

</p>
<pre><code class="javascript">casper.start();

casper.open('http://www.google.com/').then(function() {
    this.echo('GOT it.');
});

casper.run();</code></pre>
<p><strong>Example for a <code>POST</code> request:</strong>

</p>
<pre><code class="javascript">casper.start();

casper.open('http://some.testserver.com/post.php', {
    method: 'post',
    data:   {
        'title': 'Plop',
        'body':  'Wow.'
    }
});

casper.then(function() {
    this.echo('POSTED it.');
});

casper.run();</code></pre>
<p><span class="label label-warning">Warning</span> PhantomJS 1.4.0 and 1.4.1 have
introduced a <a href="http://code.google.com/p/phantomjs/issues/detail?id=337">regression</a>
with POST requests preventing data to be actually submitted; so please
check you're using a more recent or patched version of PhantomJS before
reporting any issue regarding this bug.

</p>
<h3 id="repeat"><code>Casper#repeat(int times,  function then)</code></h3>

<p>Repeats a navigation step a given number of times.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start().repeat(3, function() {
    this.echo("Badger");
});

casper.run();</code></pre>
<h3 id="resourceExists"><code>Casper#resourceExists(Mixed  test)</code></h3>

<p>Checks if a resource has been loaded. You can pass either a function or
a string to perform the test.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://www.google.com/', function() {
    if (this.resourceExists('logo3w.png')) {
        this.echo('Google logo loaded');
    } else {
        this.echo('Google logo not loaded', 'ERROR');
    }
});

casper.run();</code></pre>
<p><span class="label label-info">Note</span> If you want to wait for a resource to
be loaded, use the <a href="#waitForResource"><code>waitForResource()</code></a> method.

</p>
<h3 id="run"><code>Casper#run(fn onComplete[, int  time])</code></h3>

<p>Runs the whole suite of steps and optionally executes a callback when
they've all been done. Obviously, <strong>calling this method is mandatory</strong>
in order to run the Casper navigation suite.

</p>
<p>Casper suite <strong>won't run</strong>:

</p>
<pre><code class="javascript">casper.start('http://foo.bar/home', function() {
    // ...
});

// hey, it's missing .run() here!</code></pre>
<p>Casper suite <strong>will run</strong>:

</p>
<pre><code class="javascript">casper.start('http://foo.bar/home', function() {
    // ...
});

casper.run();</code></pre>
<p><code>Casper.run()</code> also accepts an <code>onComplete</code> callback, which you can
consider as a custom final step to perform when all the other steps have
been executed. Just don't forget to <code>exit()</code> Casper if you define one!

</p>
<pre><code class="javascript">casper.start('http://foo.bar/home', function() {
    // ...
});

casper.then(function() {
    // ...
});

casper.run(function() {
    this.echo('So the whole suite ended.');
    this.exit(); // &lt;--- don't forget me!
});</code></pre>
<h3 id="setHttpAuth"><code>Casper#setHttpAuth(String username, String password)</code></h3>

<p>Sets <code>HTTP_AUTH_USER</code> and <code>HTTP_AUTH_PW</code> values for HTTP based authentication
systems.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start();

casper.setHttpAuth('sheldon.cooper', 'b4z1ng4');

casper.thenOpen('http://password-protected.domain.tld/', function() {
    this.echo("I'm in. Bazinga.");
})
casper.run();</code></pre>
<p>Of course you can directly pass the auth string in the url to open:

</p>
<pre><code class="javascript">var url = 'http://sheldon.cooper:b4z1ng4@password-protected.domain.tld/';

casper.start(url, function() {
    this.echo("I'm in. Bazinga.");
})

casper.run();</code></pre>
<h3 id="start"><code>Casper#start(String url[, function then])</code></h3>

<p>Configures and starts Casper, then open the provided <code>url</code> and
optionally adds the step provided by the <code>then</code> argument.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://google.fr/', function() {
    this.echo("I'm loaded.");
});

casper.run();</code></pre>
<p>Alternatively:

</p>
<pre><code class="javascript">casper.start('http://google.fr/');

casper.then(function() {
    this.echo("I'm loaded.");
});

casper.run();</code></pre>
<p>Or alternatively:

</p>
<pre><code class="javascript">casper.start('http://google.fr/');

casper.then(function() {
    casper.echo("I'm loaded.");
});

casper.run();</code></pre>
<p>Or even:

</p>
<pre><code class="javascript">casper.start('http://google.fr/');

casper.then(function(self) {
    self.echo("I'm loaded.");
});

casper.run();</code></pre>
<p>Matter of taste!

</p>
<p><span class="label label-info">Note</span> <strong>You must call the <code>start()</code> method
in order to be able to add navigation steps</strong> and run the suite. If you don't
you'll get an error message inviting you to do so anyway.

</p>
<h3 id="then"><code>Casper#then(function fn)</code></h3>

<p>This method is the standard way to add a new navigation step to the stack, by
providing a simple function:

</p>
<pre><code class="javascript">casper.start('http://google.fr/');

casper.then(function() {
    this.echo("I'm in your google.");
});

casper.then(function() {
    this.echo('Now, let me write something');
});

casper.then(function() {
    this.echo('Oh well.');
});

casper.run();</code></pre>
<p>You can add as many steps as you need. Note that the current <code>Casper</code> instance
automatically binds the <code>this</code> keyword for you within step functions.

</p>
<p>To run all the steps you defined, call the <a href="#run"><code>run()</code></a> method,
and voila.

</p>
<p><span class="label label-info">Note</span> You must <a href="#start"><code>start()</code></a>
the casper instance in order to use the <code>then()</code> method.

</p>
<h3 id="thenEvaluate"><code>Casper#thenEvaluate(function fn[, Object replacements])</code></h3>

<p>Adds a new navigation step to perform code evaluation within the current
retrieved page DOM.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">// Querying for "Chuck Norris" on Google
casper.start('http://google.fr/').thenEvaluate(function(term) {
    document.querySelector('input[name="q"]').setAttribute('value', term);
    document.querySelector('form[name="f"]').submit();
}, {
    term: 'Chuck Norris'
});

casper.run();</code></pre>
<p>This method is basically a convenient a shortcut for chaining a
<a href="#then"><code>then()</code></a> and an <a href="#evaluate"><code>evaluate()</code></a>
calls.

</p>
<h3 id="thenOpen"><code>Casper#thenOpen(String location[, function then])</code></h3>

<p>Adds a new navigation step for opening a new location, and optionally
add a next step when its loaded.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://google.fr/').then(function() {
    this.echo("I'm in your google.");
});

casper.thenOpen('http://yahoo.fr/', function() {
    this.echo("Now I'm in your yahoo.")
});

casper.run();</code></pre>
<h3 id="thenOpenAndEvaluate"><code>Casper#thenOpenAndEvaluate(String location[, function then, Object replacements])</code></h3>

<p>Basically a shortcut for opening an url and evaluate code against remote
DOM environment.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://google.fr/').then(function() {
    this.echo("I'm in your google.");
});

casper.thenOpenAndEvaluate('http://yahoo.fr/', function() {
    var f = document.querySelector('form');
    f.querySelector('input[name=q]').value = 'chuck norris';
    f.submit();
});

casper.run(function() {
    this.debugPage();
    this.exit();
});</code></pre>
<h3 id="viewport"><code>Casper#viewport(Number  width, Number height)</code></h3>

<p>Changes current viewport size.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.viewport(1024, 768);</code></pre>
<p><span class="label label-info">Note</span> PhantomJS comes with a default
viewport size of 400x300, and CasperJS doesn't override it by default.

</p>
<h3 id="visible"><code>Casper#visible(String <a href="#selectors">selector</a>)</code></h3>

<p>Checks if the DOM element matching the provided <a href="selectors.html">selector expression</a> is visible
in remote page.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://google.com/', function() {
    if (this.visible('#hplogo')) {
        this.echo("I can see the logo");
    } else {
        this.echo("I can't see the logo");
    }
});</code></pre>
<h3 id="wait"><code>Casper#wait(Number timeout[, Function then])</code></h3>

<p>Pause steps suite execution for a given amount of time, and optionally
execute a step on done.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://yoursite.tld/', function() {
    this.wait(1000, function() {
        this.echo("I've waited for a second.");
    });
});

casper.run();</code></pre>
<p>You can also write the same thing like this:

</p>
<pre><code class="javascript">casper.start('http://yoursite.tld/');

casper.wait(1000, function() {
    this.echo("I've waited for a second.");
});

casper.run();</code></pre>
<h3 id="waitFor"><code>Casper#waitFor(Function testFx[, Function then, Function onTimeout, Number timeout])</code></h3>

<p>Waits until a function returns true to process any next step.

</p>
<p>You can also set a callback on timeout using the <code>onTimeout</code> argument,
and set the timeout using the <code>timeout</code> one, in milliseconds. The
default timeout is set to 5000ms.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://yoursite.tld/');

casper.waitFor(function check() {
    return this.evaluate(function() {
        return document.querySelectorAll('ul.your-list li').length &gt; 2;
    });
}, function then() {
    this.captureSelector('yoursitelist.png', 'ul.your-list');
});

casper.run();</code></pre>
<p>Example using the <code>onTimeout</code> callback:

</p>
<pre><code class="javascript">casper.start('http://yoursite.tld/');

casper.waitFor(function check() {
    return this.evaluate(function() {
        return document.querySelectorAll('ul.your-list li').length &gt; 2;
    });
}, function then() {    // step to execute when check() is ok
    this.captureSelector('yoursitelist.png', 'ul.your-list');
}, function timeout() { // step to execute if check has failed
    this.echo("I can't haz my screenshot.").exit();
});

casper.run();</code></pre>
<h3 id="waitForSelector"><code>Casper#waitForSelector(String <a href="#selectors">selector</a>[, Function then, Function onTimeout, Number timeout])</code></h3>

<p>Waits until an element matching the provided <a href="selectors.html">selector expression</a> exists in
remote DOM to process any next step. Uses
<a href="#waitFor">Casper.waitFor()</a>.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('https://twitter.com/#!/n1k0');

casper.waitForSelector('.tweet-row', function() {
    this.captureSelector('twitter.png', 'html');
});

casper.run();</code></pre>
<h3 id="waitWhileSelector"><code>Casper#waitWhileSelector(String <a href="#selectors">selector</a>[, Function then, Function onTimeout, Number timeout])</code></h3>

<p>Waits until an element matching the provided <a href="selectors.html">selector expression</a> does not
exist in remote DOM to process a next step. Uses
<a href="#waitFor">Casper.waitFor()</a>.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://foo.bar/');

casper.waitWhileSelector('.selector', function() {
    this.echo('.selector is no more!');
});

casper.run();</code></pre>
<h3 id="waitForResource"><code>Casper#waitForResource(Function testFx[, Function then, Function onTimeout, Number timeout])</code></h3>

<p>Wait until a resource that matches the given <code>testFx</code> is loaded to
process a next step. Uses <a href="#waitFor">Casper.waitFor()</a>.

</p>
<p><strong>Example:</strong>

</p>
<pre><code class="javascript">casper.start('http://foo.bar/', function() {
    this.waitForResource("foobar.png");
});

casper.then(function() {
    this.echo('foobar.png has been loaded.');
});

casper.run();</code></pre>
<p>Another way to write the exact same behavior:

</p>
<pre><code class="javascript">casper.start('http://foo.bar/');

casper.waitForResource("foobar.png", function() {
    this.echo('foobar.png has been loaded.');
});

casper.run();</code></pre>
<h3 id="waitUntilVisible"><code>Casper#waitUntilVisible(String <a href="#selectors">selector</a>[, Function then, Function onTimeout, Number timeout])</code></h3>

<p>Waits until an element matching the provided <a href="selectors.html">selector expression</a> is visible in
the remote DOM to process a next step. Uses
<a href="#waitFor">Casper.waitFor()</a>.

</p>
<h3 id="waitWhileVisible"><code>Casper#waitWhileVisible(String <a href="#selectors">selector</a>[, Function then, Function onTimeout, Number timeout])</code></h3>

<p>Waits until an element matching the provided <a href="selectors.html">selector expression</a> is no longer
visible in remote DOM to process a next step. Uses
<a href="#waitFor">Casper.waitFor()</a>.
</p>
</div>
        <div class="span3 apitoc ">
            <div class="wrapper section-toc"><h3>Quick reference</h3>
<h4>The <code>Casper</code> class</h4>
<ul>
<li><a href="#options"><code>options</code></a></li>
<li><a href="#back"><code>back()</code></a></li>
<li><a href="#base64encode"><code>base64encode()</code></a></li>
<li><a href="#click"><code>click()</code></a></li>
<li><a href="#capture"><code>capture()</code></a></li>
<li><a href="#captureSelector"><code>captureSelector()</code></a></li>
<li><a href="#clear"><code>clear()</code></a></li>
<li><a href="#debugHTML"><code>debugHTML()</code></a></li>
<li><a href="#debugPage"><code>debugPage()</code></a></li>
<li><a href="#die"><code>die()</code></a></li>
<li><a href="#download"><code>download()</code></a></li>
<li><a href="#each"><code>each()</code></a></li>
<li><a href="#echo"><code>echo()</code></a></li>
<li><a href="#evaluate"><code>evaluate()</code></a></li>
<li><a href="#evaluateOrDie"><code>evaluateOrDie()</code></a></li>
<li><a href="#exists"><code>exists()</code></a></li>
<li><a href="#exit"><code>exit()</code></a></li>
<li><a href="#fetchText"><code>fetchText()</code></a></li>
<li><a href="#forward"><code>forward()</code></a></li>
<li><a href="#log"><code>log()</code></a></li>
<li><a href="#fill"><code>fill()</code></a></li>
<li><a href="#getCurrentUrl"><code>getCurrentUrl()</code></a></li>
<li><a href="#getGlobal"><code>getGlobal()</code></a></li>
<li><a href="#getTitle"><code>getTitle()</code></a></li>
<li><a href="#mouseEvent"><code>mouseEvent()</code></a></li>
<li><a href="#open"><code>open()</code></a></li>
<li><a href="#repeat"><code>repeat()</code></a></li>
<li><a href="#resourceExists"><code>resourceExists()</code></a></li>
<li><a href="#run"><code>run()</code></a></li>
<li><a href="#setHttpAuth"><code>setHttpAuth()</code></a></li>
<li><a href="#start"><code>start()</code></a></li>
<li><a href="#then"><code>then()</code></a></li>
<li><a href="#thenEvaluate"><code>thenEvaluate()</code></a></li>
<li><a href="#thenOpen"><code>thenOpen()</code></a></li>
<li><a href="#thenOpenAndEvaluate"><code>thenOpenAndEvaluate()</code></a></li>
<li><a href="#viewport"><code>viewport()</code></a></li>
<li><a href="#visible"><code>visible()</code></a></li>
<li><a href="#wait"><code>wait()</code></a></li>
<li><a href="#waitFor"><code>waitFor()</code></a></li>
<li><a href="#waitForSelector"><code>waitForSelector()</code></a></li>
<li><a href="#waitWhileSelector"><code>waitWhileSelector()</code></a></li>
<li><a href="#waitForResource"><code>waitForResource()</code></a></li>
<li><a href="#waitUntilVisible"><code>waitUntilVisible()</code></a></li>
<li><a href="#waitWhileVisible"><code>waitWhileVisible()</code></a></li>
</ul>
</div>
        </div>
    </div>
</section>
</div>
        <footer>
            <hr>
            <p>
                © 2011-2012 <a href="https://nicolas.perriault.net/">Nicolas Perriault</a> — get
                the source code on GitHub: <a href="http://github.com/n1k0/casperjs">n1k0/casperjs</a> —
                logo by <a href="http://www.forveillejeremy.com/">Jeremy Forveille</a>
            </p>
        </footer>
    </div>
    <script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js"></script><script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js"></script><script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js"></script><script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js"></script><script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js"></script><script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js"></script><script src="https://apis.google.com/_/apps-static/_/js/gapi/plusone/rt=j/ver=LafFAl1n9F0.fr./sv=1/am=!-uF4IJcG30GIH1WarA/d=1/rs=AItRSTODVvje3v6NlgjFafbFGtWBcx-Fbg/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" async="" src="https://apis.google.com/js/plusone.js" gapi_processed="true"></script><script id="twitter-wjs" src="//platform.twitter.com/widgets.js"></script><script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="prettify/prettify.js"></script>
    <script type="text/javascript" src="js/application.js"></script>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    <script type="text/javascript">
    (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71239-7']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


</body></html>